theory IsoperimetricInequality
  imports Green
begin

find_theorems "line_integral _" "reparam"

find_theorems "line_integral _"

find_theorems "integral _" "_ \<le> _" name: le

thm Henstock_Kurzweil_Integration.integral_le

find_theorems "line_integral _"

find_theorems name: circle
thm line_integral_def

definition path_length :: "(real \<Rightarrow> real\<times>real) \<Rightarrow> real" where
  "path_length c \<equiv> integral {0..1} (\<lambda>x. \<Sum>b\<in>{(1,0),(0,1)}. (vector_derivative c (at x within {0..1}) \<bullet> b))"

definition enclosed_area :: "(real \<Rightarrow> real\<times>real) \<Rightarrow> real" where
  "enclosed_area c \<equiv> integral {0..1} (\<lambda>x. (c x \<bullet> (1,0))*(vector_derivative c (at x within {0..1}) \<bullet> (0,1)))"

definition enclosed_area_alt :: "(real \<Rightarrow> real\<times>real) \<Rightarrow> real" where
  "enclosed_area_alt c \<equiv> integral {0..1} (\<lambda>x. (c x \<bullet> (0,1))*(vector_derivative c (at x within {0..1}) \<bullet> (1,0)))"

(*Area can be given two ways. I believe "line_integral F basis c" and "line_integral G basis c" are just rewritings of enclosed_area c and enclosed_are_alt c.
So the next lemma should follow from the following. This requires Green's Theorem to be used to rewrite it as the double integral of 1 over the shape enclosed by c*)
lemma fixes F :: "real\<times>real \<Rightarrow> real\<times>real" and G :: "real\<times>real \<Rightarrow> real\<times>real"
  assumes "F (x,y) = (y,0)" and "G (x,y) = (0,-x)" and "basis  = {(1,0),(0,1)}"
  shows "line_integral F basis c = line_integral G basis c"
proof-
  show ?thesis
    sorry
qed

lemma "enclosed_area_alt c = enclosed_area c"


theorem fixes A::real and l::real and c::"real \<Rightarrow> real \<times> real" and basis :: "(real\<times>real) set"
  assumes "basis = {(1,0),(0,1)}" and "valid_path c" and "l = path_length c" and "valid_path c" and "closed_path c" and "A = enclosed_area c"
  shows "A \<le> l\<^sup>2/(4*pi)"
proof-

end